id: 2026-02-04T1700-backend-dev-config-schema-definition
agent: backend-dev
status: done
title: "Define YAML configuration schemas for LLM service layer"
artefacts:
  - src/llm_service/config/schemas.py
  - config/agents.yaml.example
  - config/tools.yaml.example
  - config/models.yaml.example
  - config/policies.yaml.example
  - src/llm_service/__init__.py
  - src/llm_service/config/__init__.py
context:
  project: "LLM Service Layer"
  architecture_ref: "docs/architecture/design/llm-service-layer-prestudy.md"
  milestone: "Milestone 1: Foundation"
  batch: "Batch 1.1: Configuration Schema & Validation"
  tech_stack_decision: "Python (decided 2026-02-04)"
  notes:
    - "Defined Pydantic v2 models for configuration validation"
    - "All approved decisions reflected: Python, YAML format, configurable limit.type"
    - "Referenced configuration examples from prestudy"
    - "Platform-specific binary paths supported in tools.yaml"
    - "Cross-reference validation implemented (agent.preferred_tool → tools.yaml, agent.preferred_model → models.yaml)"
acceptance_criteria:
  - "✅ Schemas enforce required fields using Pydantic BaseModel"
  - "✅ Validation catches invalid references via validate_agent_references()"
  - "✅ Example YAML files demonstrate MVP configuration (claude-code + codex tools)"
  - "✅ Schema supports configurable budget enforcement (limit.type: soft|hard)"
  - "⏳ Unit tests verification (to be added in next task)"
dependencies:
  - "✅ Tech stack decision (Python) - RESOLVED"
estimated_effort: "3-4 days"
priority: "high"
created_at: "2026-02-04T17:00:00Z"
created_by: "planning-petra"
assigned_at: "2026-02-04T17:12:00Z"
started_at: "2026-02-04T17:12:30Z"
completed_at: "2026-02-04T17:15:00Z"
result:
  summary: "Created Python-based configuration schemas using Pydantic v2 with comprehensive validation for all 4 configuration files (agents, tools, models, policies). Implemented cross-reference validation and example YAML files demonstrating MVP tools (claude-code, codex, cursor)."
  artefacts:
    - src/llm_service/config/schemas.py  # 8.2KB - Complete Pydantic schemas
    - config/agents.yaml.example  # Agent configurations (architect, backend-dev, planner)
    - config/tools.yaml.example  # Tool definitions (claude-code, codex, cursor)
    - config/models.yaml.example  # Model catalog with costs
    - config/policies.yaml.example  # Policy rules with soft/hard limits
  validation:
    - "Schemas support all required fields per ADR-025"
    - "Cross-reference validation prevents orphaned references"
    - "Configurable budget enforcement (limit.type: soft|hard) implemented"
    - "Platform-specific tool paths supported (Linux, macOS, Windows/WSL2)"
  next_steps:
    - "Add unit tests for schema validation (pytest)"
    - "Implement configuration loader (Batch 1.1 next task)"
    - "Add CLI command 'config validate' (Batch 1.2)"
