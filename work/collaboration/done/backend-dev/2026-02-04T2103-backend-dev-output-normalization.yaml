id: 2026-02-04T2103-backend-dev-output-normalization
agent: backend-dev
status: assigned
priority: medium
title: Output Normalization Framework Implementation
artefacts:
- src/llm_service/adapters/output_normalizer.py
- tests/unit/adapters/test_output_normalizer.py
context:
  background: 'Different tools (claude-code, codex) return different output formats.

    Need to normalize outputs for consistent telemetry and error handling.

    '
  milestone: 'Milestone 2: Tool Integration'
  batch: 'M2 Batch 2.1: Adapter Base Interface'
  strategic_value: Standardizes tool responses for M3 telemetry integration
requirements:
  output_normalization:
  - Extract LLM response text from tool output
  - Parse metadata (tokens, model, cost) when available
  - Identify errors vs. warnings
  - Standardize format across different tools
  format_support:
  - JSON structured output parsing
  - Plain text unstructured extraction
  - Mixed format (text + metadata)
  - Tool-specific format handling
  extensibility:
  - Easy to add new tool output formats
  - Plugin-like architecture for format handlers
  - Clear interface for tool-specific normalizers
  result_structure:
  - NormalizedResponse dataclass (response_text, metadata, errors)
  - Type-safe metadata handling
acceptance_criteria:
- Output normalization handles JSON and plain text
- Metadata extracted when available in tool output
- Errors identified and standardized across tools
- '>80% test coverage on normalizer'
- Ready for claude-code and codex adapters (different formats)
- Clear examples of normalization for each format type
dependencies:
- 2026-02-04T2102-backend-dev-subprocess-wrapper
created_at: '2026-02-05T05:03:00Z'
created_by: orchestrator
estimated_hours: 2.5
assigned_at: '2026-02-05T05:11:56.379225Z'
