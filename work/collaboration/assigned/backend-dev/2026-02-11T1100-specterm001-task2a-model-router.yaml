---
# Task Descriptor: SPEC-TERM-001 Task 2a - Refactor ModelConfigurationManager → ModelRouter
id: "2026-02-11T1100-specterm001-task2a-model-router"
title: "SPEC-TERM-001 Task 2a: Refactor ModelConfigurationManager → ModelRouter"
assignee: backend-dev
batch: "SPEC-TERM-001"
priority: HIGH
status: assigned
created: "2026-02-11T11:00:00Z"
specification: "specifications/initiatives/terminology-alignment-refactoring.md"
related_decisions:
  - "specifications/initiatives/terminology-alignment-refactoring.md"
dependencies:
  - type: prerequisite
    task_id: "2026-02-11T1100-adr045-task5-dashboard-integration"
    description: "M5.1 must be complete before starting SPEC-TERM-001 refactoring"
blocks:
  - "2026-02-11T1100-specterm001-task2b-template-renderer"
estimated_hours: 8
tags:
  - spec-term-001
  - refactoring
  - model-router
  - terminology-alignment
---

# Task: Refactor ModelConfigurationManager → ModelRouter

## Context

**Initiative:** SPEC-TERM-001 - Terminology Alignment Refactoring  
**Batch:** Phase 2 - Core Component Refactoring  
**Strategic Goal:** Rename class to reflect routing responsibility with domain-driven terminology

**Why This Matters:**
- "Manager" is generic and lacks domain meaning
- "Router" accurately reflects responsibility (routing requests to models)
- Aligns with domain glossary
- Sets precedent for subsequent refactorings
- Reduces conceptual drift

## Objective

Rename `ModelConfigurationManager` to `ModelRouter` and update all references. Refactor methods to use domain language (configure → route). Update tests, documentation, and imports across codebase.

## Acceptance Criteria

**MUST:**
- [ ] Class renamed from `ModelConfigurationManager` to `ModelRouter`
- [ ] Primary methods renamed (`configure` → `route`, etc.)
- [ ] All imports updated across codebase
- [ ] Tests updated (class name, method names)
- [ ] Documentation updated (docstrings, README, guides)
- [ ] Glossary entry added for "ModelRouter"
- [ ] All tests pass (no regressions)

**SHOULD:**
- [ ] Method signatures improved (if clarity gains)
- [ ] Error messages updated to use new terminology
- [ ] Logging statements updated
- [ ] Type hints preserved/improved

**MUST NOT:**
- [ ] Change business logic (behavior must remain identical)
- [ ] Break existing API contracts (if externally used)
- [ ] Introduce new features (pure refactoring only)

## Deliverables

1. **Refactored Code:**
   - `src/{path}/model_router.py` (renamed from model_configuration_manager.py)
   - Updated method names and docstrings
   - Updated error messages

2. **Updated Tests:**
   - `tests/unit/{path}/test_model_router.py` (renamed)
   - All test cases updated
   - No functional changes (same behavior)

3. **Updated Documentation:**
   - `docs/{relevant}/model-router.md` (if exists)
   - Updated docstrings
   - README updates (if referenced)

4. **Glossary Entry:**
   - `docs/glossary.md` - Add "ModelRouter" definition

5. **Migration Log:**
   - `work/refactoring/specterm001-task2a-log.md`
   - Files changed
   - Methods renamed
   - Validation results

## Test Plan

**Validation Strategy:**
1. Run existing tests before refactoring (establish baseline)
2. Rename class and file
3. Run tests → expect failures (name mismatch)
4. Update test names
5. Run tests → should pass (same behavior)
6. Update imports across codebase
7. Run full test suite → should pass
8. Manual spot-check critical paths

**Test Commands:**
```bash
# Baseline (before refactoring)
pytest tests/unit/{path}/test_model_configuration_manager.py -v

# After class rename (expect failures)
pytest tests/unit/{path}/test_model_router.py -v

# After test updates (should pass)
pytest tests/unit/{path}/test_model_router.py -v

# Full suite (must pass)
pytest tests/ -v

# Type checking
mypy src/ --strict
```

## Implementation Notes

### Renaming Strategy

**Step 1: Identify Current Usage**
```bash
# Find all references to ModelConfigurationManager
grep -r "ModelConfigurationManager" src/ tests/ docs/

# Find file location
find src/ -name "*model_configuration_manager.py"
```

**Step 2: Rename Class and File**
```bash
# Rename file
git mv src/{path}/model_configuration_manager.py src/{path}/model_router.py

# Update class name in file
# OLD: class ModelConfigurationManager:
# NEW: class ModelRouter:
```

**Step 3: Update Method Names**
```python
# src/{path}/model_router.py

# BEFORE
class ModelConfigurationManager:
    def configure(self, model_name: str, config: dict):
        """Configure model with given settings."""
        pass
    
    def get_configuration(self, model_name: str):
        """Get model configuration."""
        pass

# AFTER
class ModelRouter:
    """Routes requests to appropriate language models.
    
    Responsibilities:
    - Route requests to correct model based on task type
    - Manage model selection logic
    - Provide fallback routing when primary model unavailable
    """
    
    def route(self, task_type: str, context: dict):
        """Route request to appropriate model.
        
        Args:
            task_type: Type of task requiring model inference
            context: Request context (may influence routing)
        
        Returns:
            Model identifier for routing target
        """
        pass
    
    def get_route(self, task_type: str):
        """Get routing configuration for task type."""
        pass
```

**Step 4: Update Imports**
```bash
# Find all imports
grep -r "from.*model_configuration_manager import" src/ tests/
grep -r "import.*model_configuration_manager" src/ tests/

# Update each file
# OLD: from src.{path}.model_configuration_manager import ModelConfigurationManager
# NEW: from src.{path}.model_router import ModelRouter
```

**Step 5: Update Tests**
```python
# tests/unit/{path}/test_model_router.py (renamed)

# BEFORE
from src.{path}.model_configuration_manager import ModelConfigurationManager

class TestModelConfigurationManager:
    def test_configure(self):
        manager = ModelConfigurationManager()
        manager.configure("gpt-4", {...})

# AFTER
from src.{path}.model_router import ModelRouter

class TestModelRouter:
    def test_route(self):
        router = ModelRouter()
        model = router.route("code-generation", {...})
```

### Glossary Entry Template

Add to `docs/glossary.md`:

```markdown
## ModelRouter

**Domain:** Language Model Infrastructure  
**Definition:** Component responsible for routing requests to appropriate language models based on task type and context.

**Responsibilities:**
- Route requests to correct model
- Apply fallback logic when primary model unavailable
- Manage model selection policies

**Related Terms:**
- Model (the LLM being routed to)
- Router (general routing concept)

**Anti-Pattern:** ModelConfigurationManager (too generic, "manager" lacks domain meaning)

**Example Usage:**
```python
router = ModelRouter()
model = router.route(task_type="code-review", context={...})
```

**Related ADRs:** SPEC-TERM-001 (Terminology Alignment)
```

### Migration Log Template

Create `work/refactoring/specterm001-task2a-log.md`:

```markdown
# SPEC-TERM-001 Task 2a: ModelRouter Refactoring Log

**Date:** 2026-02-11  
**Agent:** Backend Dev  
**Objective:** Rename ModelConfigurationManager → ModelRouter

## Files Changed

### Renamed Files
- `src/{path}/model_configuration_manager.py` → `src/{path}/model_router.py`
- `tests/unit/{path}/test_model_configuration_manager.py` → `tests/unit/{path}/test_model_router.py`

### Updated Files (Imports)
- `src/{file1}.py` - Import updated
- `src/{file2}.py` - Import updated
- `tests/{file3}.py` - Import updated
(Total: X files updated)

## Methods Renamed

- `configure()` → `route()`
- `get_configuration()` → `get_route()`
- `set_default_configuration()` → `set_default_route()`

## Validation Results

- **Tests Before:** PASS (124/124)
- **Tests After:** PASS (124/124)
- **Type Checking:** PASS (0 errors)
- **Import Errors:** None detected

## Risks Mitigated

- Git history preserved (git mv)
- Behavior unchanged (tests validate)
- All imports updated (no missing references)

## Completion

✅ Class renamed  
✅ Methods renamed  
✅ Tests updated  
✅ Documentation updated  
✅ Glossary entry added  
✅ Task 2b unblocked
```

## Risk Assessment

**RISK:** Medium (breaking changes, but isolated to one class)

**Mitigation:**
- Git history preserved (git mv)
- Tests validate behavior unchanged
- Incremental approach (file, then class, then methods, then imports)
- Full test suite run after each major change
- Type checking catches missing updates

## Definition of Done

- [ ] Class renamed ModelRouter
- [ ] File renamed model_router.py
- [ ] Methods renamed (configure → route)
- [ ] All imports updated (no errors)
- [ ] Tests pass (100% pass rate)
- [ ] Type checking passes (mypy strict)
- [ ] Documentation updated
- [ ] Glossary entry added
- [ ] Migration log created
- [ ] Task 2b unblocked (TemplateRenderer)

## References

- **Specification:** `specifications/initiatives/terminology-alignment-refactoring.md` (SPEC-TERM-001)
- **Glossary:** `docs/glossary.md`
- **Planning:** `docs/planning/NEXT_BATCH.md`

---

**Estimated Effort:** 8 hours  
**Agent:** Backend Dev  
**Batch:** SPEC-TERM-001 Phase 2  
**Priority:** ⭐⭐⭐⭐ HIGH (first major refactoring, sets precedent)  
**Dependencies:** M5.1 must be complete
