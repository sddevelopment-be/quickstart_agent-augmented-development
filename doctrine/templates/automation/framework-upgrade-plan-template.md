# Framework Update/Upgrade Plan

> Generated by: Framework Guardian Agent  
> Project: {{project_name}}  
> Date: {{timestamp}}  
> Previous framework version: {{current_framework_version}}  
> Target framework version: {{target_framework_version}}  
> Upgrade script run: {{yes/no}}  
> Conflict files detected: {{number}}

This upgrade plan proposes **safe, minimal, intentional updates** to align this project with the target framework version while preserving all local customizations and project intent.

---

## 1. Summary

### Overall Upgrade Assessment
- Framework version gap: {{minor/major/breaking}}  
- Core files changed: {{count}}  
- Local overrides detected: {{count}}  
- Conflicts requiring manual review: {{count}}  
- Auto-merge candidates: {{count}}  

### Guardian Recommendation
> {{1–3 sentences summarizing recommended upgrade strategy}}  
> Example: “Upgrade is low-risk. Most changes are additive. Only minor manual merges required.”

---

## 2. Upgrade Items Overview

This section lists **all files touched by the upgrade** as detected by `framework_upgrade.sh` and the manifest.

Status types:
- **NEW** — framework added this file  
- **UNCHANGED** — local file matches framework version  
- **UPDATED** — framework has new version, no conflict  
- **CONFLICT** — local modifications diverge; `.framework-new` exists  
- **LOCAL-ONLY** — project-specific file; not managed by framework  
- **MOVED/OVERRIDDEN** — local overrides shadow core files

### Summary Table

| File Path | Status | Resolution Required | Notes |
|-----------|--------|---------------------|-------|
| {{e.g., `.github/agents/lexical.agent.md`}} | CONFLICT | manual merge | local overrides detected |
| {{e.g., `templates/agent-tasks/structural.md`}} | UPDATED | auto | no local modifications |
| {{e.g., `docs/directives/directive_minimal-diffs.md`}} | NEW | copy | new directive |
| {{…}} | {{…}} | {{…}} | {{…}} |

---

## 3. Detailed Conflict Analysis

This section is critical for Codex and the Guardian agent — they look here to produce clean diffs and merge instructions.

For each file with a `.framework-new` variant:

---

### 3.1 {{file_path}}
**Status:** CONFLICT  
**Existing file:** `{{file_path}}`  
**New framework version:** `{{file_path}}.framework-new`

#### Diff Summary
> {{Short natural-language summary of differences. E.g.:}}  
> - Local file contains project-specific directives.  
> - Framework version adds new “context loading” section.  
> - No direct overlap; merge is safe.

#### Recommended Merge Strategy
- **Keep local modifications** (they reflect project intent).  
- **Apply the following minimal diffs** from the new framework version:  
  - {{list lines or features to integrate}}  
- **Resulting file** should include:  
  - {{File sections to retain}}  
  - {{File sections to insert}}

#### Suggested Patch (minimal-diff form)
```diff
{{Guardian inserts or Codex fills in suggested diff here}}
````

#### Follow-up Action

* Consider moving project-specific parts into `local/agents/` to avoid future conflicts.

---

(Repeat the above block for each conflict.)

---

## 4. Auto-Merge Items (Safe to Apply)

These files changed in the framework but have **no local modifications**.

### 4.1 List of Auto-Merge Files

* {{list file paths}}

### Notes

> {{guardian summarises: e.g., “These changes add new directives but do not override local choices.”}}

---

## 5. New Core Files

These files did not exist locally but are now included in the framework.

### 5.1 Files to Add

* {{list new files}}

### Recommended Action

* Copy these as-is (already done by the upgrade script).
* Review new directives/guidelines and integrate them if project uses them.

---

## 6. Deprecated or Removed Files

(Only included if framework version includes deprecations.)

### 6.1 Deprecated Files

* {{list}}

### Recommendation

* Remove or relocate these files depending on usage.
* Guardian notes if any are referenced by local agents or guidelines.

---

## 7. Check Local Overrides

These files shadow core versions (intentionally or accidentally):

* {{list local override paths}}

### Guardian Review

> {{notes about potential issues, e.g.}}
> “Local lexical agent diverges heavily from core. Recommend merging shared directives to reduce future conflict.”

---

## 8. Post-Upgrade Checks

Guardian should verify:

* [ ] Framework version updated in `.framework_meta.yml`
* [ ] No unmerged `.framework-new` files remain
* [ ] Orchestration structure intact (`work/`)
* [ ] Task schema up to date
* [ ] Agent definitions load correct guidelines + directives
* [ ] Documentation references remain consistent

---

## 9. Final Recommendation

**Upgrade Readiness:** {{READY / NEEDS-MANUAL-MERGE / BLOCKED}}

**Guardian Summary:**

> {{final synthesized recommendation}}
> Example:
> “Upgrade is ready after merging two small patches. No breaking changes in local overrides. Future upgrades will be easier if lexical and structural agents are moved to `local/agents/`.”

---

## 10. Appendix

### 10.1 Manifest Summary

* Framework version: {{version}}
* Managed core paths:

    * {{list}}
* Modes: sync-always, copy-once, reference-only

### 10.2 Detected Zip Metadata

* Release notes: included / not included
* Upgrade path: {{e.g., “1.1 → 1.2 non-breaking”}}


---

# Notes on Design

This template is:

- **Highly structured** → ideal for Codex parsing & writing  
- **Hierarchical & predictable** → ideal for the Guardian agent  
- **Minimal-diff friendly** → good for upgrade workflows  
- **Readable & reviewable** → good for humans  
- **Future-proof** → works with your zip-install-and-upgrade model  
- **Platform-agnostic** → no GitHub dependencies  

